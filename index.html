<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" href="node_modules/reveal.js/css/reveal.css" />
        <link rel="stylesheet" href="node_modules/reveal.js/css/theme/solarized.css" />
        <link rel="stylesheet" href="node_modules/reveal.js/lib/css/zenburn.css" />
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section data-markdown>
                    ## Les bonnes pratiques : Dependency Injection
                </section>
                <section data-markdown>
                    <textarea data-template>
                        Nous avons déjà tous codé de cette manière de récupérer les paramètres en provenance des fichiers `config.yml` et configurer les différentes services.
                        <pre><code class="hljs php" data-trim data-noescape>
                            // CreadsHubspotExtensio.php
                            public function load(array $configs, ContainerBuilder $container)
                            {
                                $configuration = new Configuration();
                                $config = $this->processConfiguration($configuration, $configs);
                                $loader = new Loader\XmlFileLoader($container, new FileLocator(__DIR__.'/../Resources/config'));
                                $loader->load('services.xml');
                                $container->setParameter('creads_hubspot.base_url', $config['base_url']);
                                $container->setParameter('creads_hubspot.api_key', $config['api_key']);
                                $container->setParameter('creads_hubspot.hubspot_owner_id', $config['hubspot_owner_id']);
                                $container->setParameter('creads_hubspot.enabled', $config['enabled']);
                            }
                        </code></pre>

                        Nous allons voir pourquoi ce n'est pas la meilleure manière de le faire <!-- .element: class="fragment fade-right" -->
                    </textarea>
                </section>
                <section data-markdown>
                    <textarea data-template>
                        ### Problème
                        1. Le container contient les paramètres inutilement accessible à tous les bundles <!-- .element: class="fragment fade-right" data-fragment-index="1" -->
                        2. Problème de sécurité <!-- .element: class="fragment fade-right" data-fragment-index="2" -->
                        <pre><code class="hljs php" data-trim data-noescape>
                            $container->setParameter('creads_hubspot.api_key', $config['api_key']);
                        </code></pre> <!-- .element: class="fragment fade-right" data-fragment-index="3" -->
                    </textarea>
                </section>
            </div>
        </div>
        <script src="node_modules/reveal.js/lib/js/head.min.js"></script>
        <script src="node_modules/reveal.js/js/reveal.js"></script>
        <script>
            Reveal.initialize({
                width: "100%",
                // height: "100%",
                // margin: 0,
                // minScale: 1,
                // maxScale: 1,
                dependencies: [
                    // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
                    {
                        src: 'node_modules/reveal.js/lib/js/classList.js',
                        condition: function() { return !document.body.classList; }
                    },

                    // Interpret Markdown in <section> elements
                    {
                        src: 'node_modules/reveal.js/plugin/markdown/marked.js',
                        condition: function() { return !!document.querySelector( '[data-markdown]' ); }
                    }, {
                        src: 'node_modules/reveal.js/plugin/markdown/markdown.js',
                        condition: function() { return !!document.querySelector( '[data-markdown]' ); }
                    },

                    // Syntax highlight for <code> elements
                    {
                        src: 'node_modules/reveal.js/plugin/highlight/highlight.js',
                        async: true,
                        callback: function() { hljs.initHighlightingOnLoad(); }
                    }
                ]
            });
        </script>
    </body>
</html>